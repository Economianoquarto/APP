<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Caio Lopes">
<meta name="dcterms.date" content="2025-04-19">

<title>APP - Introdução à avaliação de Impacto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">APP</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Introdução à avaliação de Impacto</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Ensino</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Caio Lopes </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 19, 2025</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introdução-desvendando-o-impacto-real-das-ações" class="level2">
<h2 class="anchored" data-anchor-id="introdução-desvendando-o-impacto-real-das-ações">Introdução: Desvendando o Impacto Real das Ações</h2>
<p>Você já se perguntou qual o verdadeiro efeito de um novo programa educacional nas notas dos alunos? Ou se uma campanha de marketing realmente aumentou as vendas de um produto? A <strong>avaliação de impacto</strong> é a ferramenta que nos permite responder a essas perguntas de forma rigorosa. Ela busca medir a contribuição de uma intervenção ou programa para um resultado de interesse, comparando o que aconteceu com a intervenção com o que teria acontecido sem ela — o chamado <strong>contrafactual</strong>.</p>
<p>O grande desafio é que nunca observamos essa realidade alternativa. Não podemos, para o mesmo indivíduo e ao mesmo tempo, saber o que aconteceria com e sem o programa. Portanto, a avaliação de impacto é, em essência, um exercício de construção de um contrafactual crível para isolar o efeito causal da intervenção de todos os outros fatores que podem influenciar o resultado.</p>
<p>Neste guia, vamos explorar os conceitos e métodos que formam a base da avaliação de impacto e da inferência causal, desde a teoria dos resultados potenciais até as técnicas mais utilizadas no mercado e na academia.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
O Problema Central
</div>
</div>
<div class="callout-body-container callout-body">
<p>O desafio da avaliação de impacto é estimar um contrafactual — o que teria acontecido na ausência do programa — para isolar o verdadeiro efeito da intervenção.</p>
</div>
</div>
</section>
<section id="quando-avaliar-ex-ante-vs.-ex-post" class="level2">
<h2 class="anchored" data-anchor-id="quando-avaliar-ex-ante-vs.-ex-post">Quando Avaliar: Ex-Ante vs.&nbsp;Ex-Post</h2>
<p>A decisão de quando realizar uma avaliação de impacto é crucial e depende dos objetivos. Existem dois momentos principais:</p>
<ul>
<li><p><strong>Avaliação Ex-Ante:</strong> Realizada <em>antes</em> da implementação do programa, ela projeta os possíveis impactos e custos. Seu principal objetivo é informar a decisão sobre a adoção do programa, comparar alternativas de desenho e justificar o investimento. Por natureza, baseia-se em modelos teóricos e simulações, pois ainda não existem dados de beneficiários.</p></li>
<li><p><strong>Avaliação Ex-Post:</strong> Realizada <em>durante</em> ou <em>após</em> a execução do programa. Ela pode ser:</p>
<ul>
<li><strong>De percurso:</strong> Acontece enquanto o programa está em andamento. É ideal para verificar se as previsões ex-ante estão se confirmando e para orientar ajustes, aperfeiçoando o desenho em tempo real. É comum em programas piloto ou contínuos.</li>
<li><strong>De encerramento:</strong> Feita após o término da intervenção, busca julgar a eficácia da alocação de recursos e capturar impactos de longo prazo, que podem demorar a se manifestar. Ajuda a consolidar o aprendizado e a informar o desenho de futuros programas.</li>
</ul></li>
</ul>
<p>Em resumo, a avaliação ex-ante foca no planejamento e na otimização do desenho, enquanto a ex-post se concentra em medir o impacto real e gerar aprendizados a partir da experiência.</p>
</section>
<section id="correlação-não-implica-causalidade" class="level2">
<h2 class="anchored" data-anchor-id="correlação-não-implica-causalidade">Correlação não Implica Causalidade</h2>
<p>Um dos mantras mais repetidos em estatística e ciência de dados é: <strong>correlação não implica causalidade</strong>. Encontrar uma associação estatística entre duas variáveis, A e B, não é suficiente para concluir que A causa B. Existem pelo menos quatro possibilidades:</p>
<ol type="1">
<li><strong>Causalidade Direta:</strong> A de fato causa B (A → B).</li>
<li><strong>Causalidade Reversa:</strong> B, na verdade, causa A (B → A).</li>
<li><strong>Fator de Confusão:</strong> Uma terceira variável, C, é a verdadeira causa tanto de A quanto de B (A ← C → B).</li>
<li><strong>Coincidência:</strong> A correlação observada é puramente acidental, um ruído nos dados sem significado prático.</li>
</ol>
<p>Por exemplo, o aumento nas vendas de sorvete pode estar correlacionado com o aumento no número de afogamentos. Seria um erro concluir que tomar sorvete causa afogamentos. O fator de confusão aqui é o <strong>verão</strong>: dias mais quentes (C) levam as pessoas a comprarem mais sorvete (A) e também a nadarem mais (B), aumentando o risco de afogamentos.</p>
<p>Para que a causalidade de A para B seja plausível, a correlação é uma condição necessária (a menos que um outro fator C anule exatamente o efeito de A), mas definitivamente não é uma condição suficiente. A inferência causal busca justamente métodos para ir além da simples correlação e isolar o verdadeiro efeito causal.</p>
</section>
<section id="o-modelo-de-resultados-potenciais-formalizando-a-causalidade" class="level2">
<h2 class="anchored" data-anchor-id="o-modelo-de-resultados-potenciais-formalizando-a-causalidade">O Modelo de Resultados Potenciais: Formalizando a Causalidade</h2>
<p>Para superar o desafio do contrafactual, o <strong>Modelo de Resultados Potenciais</strong> (Potential Outcomes), popularizado por Donald Rubin, oferece uma estrutura conceitual poderosa. A ideia é definir a causalidade em termos de resultados que <em>poderiam</em> ter acontecido.</p>
<section id="a-ideia-central" class="level3">
<h3 class="anchored" data-anchor-id="a-ideia-central">A Ideia Central</h3>
<p>Para cada unidade de análise (um indivíduo, uma empresa, uma escola), imaginamos dois estados do mundo:</p>
<ul>
<li><span class="math inline">\(Y_i^1\)</span>: O resultado que a unidade <em>i</em> teria se recebesse o tratamento (D=1).</li>
<li><span class="math inline">\(Y_i^0\)</span>: O resultado que a mesma unidade <em>i</em> teria se não recebesse o tratamento (D=0).</li>
</ul>
<p>O <strong>efeito causal individual</strong> do tratamento para a unidade <em>i</em> é a diferença entre esses dois resultados potenciais:</p>
<p><span class="math display">\[
\delta_i = Y_i^1 - Y_i^0
\]</span></p>
<p>O problema fundamental, como já vimos, é que para cada unidade <em>i</em>, só podemos observar um desses resultados. O outro permanece um contrafactual. A equação de comutação formaliza isso:</p>
<p><span class="math display">\[
Y_i = D_i \cdot Y_i^1 + (1 - D_i) \cdot Y_i^0
\]</span></p>
<p>Onde <span class="math inline">\(D_i\)</span> é uma variável que indica se a unidade <em>i</em> recebeu o tratamento (<span class="math inline">\(D_i=1\)</span>) ou não (<span class="math inline">\(D_i=0\)</span>).</p>
</section>
<section id="efeitos-médios-de-interesse" class="level3">
<h3 class="anchored" data-anchor-id="efeitos-médios-de-interesse">Efeitos Médios de Interesse</h3>
<p>Como não podemos estimar o efeito individual para todos, o foco da avaliação de impacto se volta para os <strong>efeitos médios</strong> em uma população:</p>
<ul>
<li><p><strong>ATE (Average Treatment Effect):</strong> O efeito médio do tratamento para a população como um todo. É a média de todos os efeitos individuais.</p>
<p><span class="math display">\[
ATE = E[\delta_i] = E[Y^1] - E[Y^0]
\]</span></p></li>
<li><p><strong>ATT (Average Treatment Effect on the Treated):</strong> O efeito médio do tratamento apenas para aqueles que efetivamente o receberam.</p>
<p><span class="math display">\[
ATT = E[\delta_i | D=1] = E[Y^1 | D=1] - E[Y^0 | D=1]
\]</span></p></li>
<li><p><strong>ATU (Average Treatment Effect on the Untreated):</strong> O efeito médio do tratamento caso ele fosse aplicado naqueles que não o receberam.</p>
<p><span class="math display">\[
ATU = E[\delta_i | D=0] = E[Y^1 | D=0] - E[Y^0 | D=0]
\]</span></p></li>
</ul>
<p>Quando os efeitos do tratamento são heterogêneos (ou seja, variam entre os indivíduos), esses três parâmetros podem ser bem diferentes. Por exemplo, um programa de qualificação profissional pode ter um impacto muito maior (ATT) para os que escolheram participar do que teria para a população em geral (ATE).</p>
</section>
<section id="por-que-a-simples-comparação-de-médias-é-enganosa" class="level3">
<h3 class="anchored" data-anchor-id="por-que-a-simples-comparação-de-médias-é-enganosa">Por que a Simples Comparação de Médias é Enganosa</h3>
<p>Uma primeira abordagem, mais ingênua, seria simplesmente comparar a média do resultado para o grupo que recebeu o tratamento com a média do grupo que não recebeu:</p>
<p><span class="math display">\[
\text{Diferença ingênua} = E[Y | D=1] - E[Y | D=0]
\]</span></p>
<p>No entanto, essa diferença quase nunca corresponde ao verdadeiro efeito causal. Uma decomposição matemática revela por quê:</p>
<p><span class="math display">\[
E[Y | D=1] - E[Y | D=0] = ATT + (E[Y^0 | D=1] - E[Y^0 | D=0])
\]</span></p>
<p>O segundo termo, <span class="math inline">\(E[Y^0 | D=1] - E[Y^0 | D=0]\)</span>, é o <strong>viés de seleção</strong>. Ele representa a diferença que já existia entre os grupos <em>antes mesmo do tratamento</em>. Se os indivíduos que procuram um curso de qualificação (D=1) já são, em média, mais motivados e teriam salários mais altos (<span class="math inline">\(Y^0\)</span>) do que os que não procuram (D=0), a comparação simples irá superestimar o efeito do curso, misturando o impacto real com essa diferença pré-existente.</p>
<blockquote class="blockquote">
<p>A moral da história é que as escolhas (auto-seleção para o tratamento) são geralmente <strong>endógenas</strong>, ou seja, correlacionadas com os resultados potenciais. Sem uma fonte de variação <strong>exógena</strong> (aleatória), a comparação bruta é quase sempre enviesada.</p>
</blockquote>
</section>
</section>
<section id="decompondo-o-ate" class="level2">
<h2 class="anchored" data-anchor-id="decompondo-o-ate">Decompondo o ATE</h2>
<p>Uma das relações mais importantes na inferência causal é como o <strong>Average Treatment Effect (ATE)</strong> pode ser decomposto em função do <strong>Average Treatment Effect on the Treated (ATT)</strong> e do <strong>Average Treatment Effect on the Untreated (ATU)</strong>. Esta decomposição é crucial para entender a heterogeneidade dos efeitos do tratamento, o viés de seleção e como generalizar resultados de um grupo para toda a população.</p>
<p>O ATE pode ser expresso como uma média ponderada do ATT e ATU, onde os pesos são as proporções de indivíduos tratados e não tratados na população:</p>
<p><span class="math display">\[
ATE = P(D=1) \times ATT + P(D=0) \times ATU
\]</span></p>
<p>Essa fórmula nos mostra que o efeito médio geral é uma combinação dos efeitos específicos em cada grupo. Se o efeito do tratamento for maior para aqueles que o escolheram (ATT &gt; ATU), e esse grupo for grande, o ATE será mais próximo do ATT. A derivação matemática, baseada na lei da expectativa total, revela como essa relação emerge naturalmente das definições de cada parâmetro.</p>
<p>_</p>
<section id="exemplo-prático-programa-de-treinamento-profissional" class="level3">
<h3 class="anchored" data-anchor-id="exemplo-prático-programa-de-treinamento-profissional">Exemplo Prático: Programa de Treinamento Profissional</h3>
<p>Imagine um programa de treinamento profissional onde 40% dos trabalhadores elegíveis decidem participar. É razoável supor que aqueles que participam são diferentes daqueles que não participam (e.g., mais motivados), e que o efeito do treinamento pode ser diferente para esses dois grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurando dados hipotéticos</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>prop_treated <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Efeitos heterogêneos</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>att_true <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>atu_true <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Resultados potenciais</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>n_treated <span class="ot">&lt;-</span> <span class="fu">round</span>(n_total <span class="sc">*</span> prop_treated)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y0_treated <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_treated, <span class="at">mean =</span> <span class="dv">30000</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>y1_treated <span class="ot">&lt;-</span> y0_treated <span class="sc">+</span> att_true <span class="sc">+</span> <span class="fu">rnorm</span>(n_treated, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>n_untreated <span class="ot">&lt;-</span> n_total <span class="sc">-</span> n_treated</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>y0_untreated <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_untreated, <span class="at">mean =</span> <span class="dv">25000</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>y1_untreated <span class="ot">&lt;-</span> y0_untreated <span class="sc">+</span> atu_true <span class="sc">+</span> <span class="fu">rnorm</span>(n_untreated, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1000</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando data frame</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_total,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">D =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n_treated), <span class="fu">rep</span>(<span class="dv">0</span>, n_untreated)),</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y0 =</span> <span class="fu">c</span>(y0_treated, y0_untreated),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y1 =</span> <span class="fu">c</span>(y1_treated, y1_untreated)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y_obs =</span> D <span class="sc">*</span> Y1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> D) <span class="sc">*</span> Y0)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculando os efeitos</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>effects <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">ATT =</span> <span class="fu">mean</span>(Y1[D <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(Y0[D <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">ATU =</span> <span class="fu">mean</span>(Y1[D <span class="sc">==</span> <span class="dv">0</span>]) <span class="sc">-</span> <span class="fu">mean</span>(Y0[D <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">ATE_direct =</span> <span class="fu">mean</span>(Y1) <span class="sc">-</span> <span class="fu">mean</span>(Y0),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_treated =</span> <span class="fu">mean</span>(D)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ATE_decomposed =</span> prop_treated <span class="sc">*</span> ATT <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> prop_treated) <span class="sc">*</span> ATU)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Exibindo resultados</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ATT (efeito nos tratados): $"</span>, <span class="fu">round</span>(effects<span class="sc">$</span>ATT, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ATT (efeito nos tratados): $ 4907.124 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ATU (efeito nos não-tratados): $"</span>, <span class="fu">round</span>(effects<span class="sc">$</span>ATU, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ATU (efeito nos não-tratados): $ 2017.598 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ATE (cálculo direto): $"</span>, <span class="fu">round</span>(effects<span class="sc">$</span>ATE_direct, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ATE (cálculo direto): $ 3173.408 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ATE (via decomposição): $"</span>, <span class="fu">round</span>(effects<span class="sc">$</span>ATE_decomposed, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ATE (via decomposição): $ 3173.408 </code></pre>
</div>
</div>
<p>Este código simula uma população onde o grupo tratado tem um salário base maior e um efeito do tratamento mais elevado, refletindo um cenário de auto-seleção positiva. Os resultados do cálculo confirmam a decomposição do ATE e mostram como o ATE é uma média ponderada do ATT e do ATU.</p>
<p><a href="ate_decomposicao.xlsx" target="_blank">Visualizar exemplo em excel</a></p>
</section>
<section id="por-que-esta-decomposição-importa" class="level3">
<h3 class="anchored" data-anchor-id="por-que-esta-decomposição-importa">Por que Esta Decomposição Importa?</h3>
<p>A decomposição do ATE em função do ATT e ATU tem implicações profundas para a interpretação de resultados e o desenho de políticas públicas.</p>
<p><strong>Viés de Seleção:</strong> A comparação ingênua entre tratados e controles pode ser decomposta como:</p>
<p><span class="math display">\[
E[Y | D=1] - E[Y | D=0] = ATT + \text{Viés de Seleção}
\]</span></p>
<p>Onde o viés de seleção é <span class="math inline">\(E[Y^0 | D=1] - E[Y^0 | D=0]\)</span>, representando a diferença que já existia entre os grupos antes do tratamento. Se os indivíduos que procuram um curso de qualificação já são mais motivados e teriam salários mais altos mesmo sem o curso, a comparação simples superestimará o efeito do programa.</p>
<p><strong>Implicações para Política Pública:</strong> Considere dois cenários para o programa de treinamento:</p>
<ol type="1">
<li><strong>Expansão Total:</strong> Oferecer o programa para toda a população elegível</li>
<li><strong>Manutenção:</strong> Manter apenas para quem já participa</li>
</ol>
<p>A análise custo-benefício deve considerar que o efeito médio para novos participantes (ATU) pode ser diferente do efeito para os participantes atuais (ATT). Se o ATU for significativamente menor que o ATT, a expansão pode não ser custo-efetiva, mesmo que o programa atual seja bem-sucedido.</p>
<p><strong>Generalização de Resultados:</strong> Quando extrapolamos resultados de um estudo para uma população diferente, precisamos considerar se a composição da nova população (proporção de “tipos” de indivíduos) é similar à do estudo original. Um programa que funciona bem em uma população com alta proporção de indivíduos motivados pode ter resultados diferentes em uma população com características distintas.</p>
<p>Podemos também criar uma visualização para melhor compreender a distribuição dos efeitos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Criando visualização dos efeitos individuais</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">individual_effect =</span> Y1 <span class="sc">-</span> Y0) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> individual_effect, <span class="at">fill =</span> <span class="fu">factor</span>(D))) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> effects<span class="sc">$</span>ATE_direct, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribuição dos Efeitos Individuais do Tratamento"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Efeito Individual ($)"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequência"</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Grupo"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Linha vermelha tracejada representa o ATE"</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Controle"</span>, <span class="st">"Tratamento"</span>)) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras mostrando a decomposição</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>decomp_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parametro =</span> <span class="fu">c</span>(<span class="st">"ATT"</span>, <span class="st">"ATU"</span>, <span class="st">"ATE"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Valor =</span> <span class="fu">c</span>(effects<span class="sc">$</span>ATT, effects<span class="sc">$</span>ATU, effects<span class="sc">$</span>ATE_direct),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Peso =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"Peso: "</span>, <span class="fu">round</span>(effects<span class="sc">$</span>prop_treated <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste0</span>(<span class="st">"Peso: "</span>, <span class="fu">round</span>((<span class="dv">1</span> <span class="sc">-</span> effects<span class="sc">$</span>prop_treated) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Média Ponderada"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(decomp_data, <span class="fu">aes</span>(<span class="at">x =</span> Parametro, <span class="at">y =</span> Valor, <span class="at">fill =</span> Parametro)) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">round</span>(Valor, <span class="dv">0</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, Peso)), </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Decomposição do ATE"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Parâmetro"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Efeito do Tratamento ($)"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Parâmetro"</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="as-hipóteses-chave-para-identificação-causal" class="level2">
<h2 class="anchored" data-anchor-id="as-hipóteses-chave-para-identificação-causal">As Hipóteses-Chave para Identificação Causal</h2>
<p>Para que possamos estimar os efeitos causais de forma válida a partir de dados observacionais, precisamos de algumas hipóteses que tornem a nossa análise crível. As três mais importantes são:</p>
<section id="ignorabilidade-ou-independência-condicional" class="level3">
<h3 class="anchored" data-anchor-id="ignorabilidade-ou-independência-condicional">1. Ignorabilidade (ou Independência Condicional)</h3>
<p>Formalmente, esta hipótese diz que, uma vez que controlamos por um conjunto de variáveis observáveis X, a alocação do tratamento é independente dos resultados potenciais.</p>
<p><span class="math display">\[
(Y^1, Y^0) \perp D \mid X
\]</span></p>
<p>Em um <strong>experimento aleatório controlado (RCT)</strong>, essa hipótese é garantida pelo próprio desenho, pois a aleatorização torna o tratamento independente de <em>qualquer</em> característica dos indivíduos, observada ou não. Em estudos observacionais, a plausibilidade da ignorabilidade depende da nossa capacidade de medir e controlar por todos os fatores de confusão relevantes (o conjunto X).</p>
</section>
<section id="suporte-comum-ou-overlap" class="level3">
<h3 class="anchored" data-anchor-id="suporte-comum-ou-overlap">2. Suporte Comum (ou Overlap)</h3>
<p>Esta hipótese garante que, para qualquer conjunto de características X, existem tanto indivíduos tratados quanto não tratados.</p>
<p><span class="math display">\[
0 &lt; P(D=1 \mid X) &lt; 1
\]</span></p>
<p>Intuitivamente, não podemos comparar o incomparável. Se um programa de reforço escolar é oferecido apenas para alunos com notas muito baixas, não temos um grupo de controle com características similares (notas baixas) para fazer a comparação. A falta de suporte comum impede a estimação do efeito causal para certos subgrupos da população.</p>
</section>
<section id="sutva-stable-unit-treatment-value-assumption" class="level3">
<h3 class="anchored" data-anchor-id="sutva-stable-unit-treatment-value-assumption">3. SUTVA (Stable Unit Treatment Value Assumption)</h3>
<p>A SUTVA é composta por duas sub-hipóteses:</p>
<ul>
<li><strong>Consistência:</strong> O resultado potencial de um indivíduo sob um determinado tratamento corresponde ao resultado observado se ele de fato recebe aquele tratamento. Isso implica que não existem múltiplas “versões” do tratamento com efeitos diferentes.</li>
<li><strong>Não-Interferência:</strong> O tratamento recebido por uma unidade não afeta os resultados potenciais de outra unidade. Por exemplo, em um programa de vacinação, a vacinação de uma pessoa pode gerar um efeito de transbordamento (spillover) positivo para outras, protegendo-as também. A SUTVA assume que esses efeitos de interferência não existem.</li>
</ul>
<p>Sem as hipóteses de ignorabilidade e suporte comum, a identificação do efeito causal falha. Sem a SUTVA, os próprios resultados potenciais não estão bem definidos.</p>
</section>
</section>
<section id="como-obter-variação-exógena-os-desenhos-clássicos-de-identificação" class="level2">
<h2 class="anchored" data-anchor-id="como-obter-variação-exógena-os-desenhos-clássicos-de-identificação">Como Obter Variação Exógena? Os Desenhos Clássicos de Identificação</h2>
<p>O grande objetivo dos métodos de inferência causal é encontrar (ou simular) uma fonte de variação no tratamento que seja “tão boa quanto aleatória”. Cada método se baseia em um conjunto diferente de hipóteses para alcançar a identificação.</p>
<section id="experimentos-aleatórios-controlados-rcts" class="level3">
<h3 class="anchored" data-anchor-id="experimentos-aleatórios-controlados-rcts">Experimentos Aleatórios Controlados (RCTs)</h3>
<p>Considerado o <strong>padrão-ouro</strong>, o RCT resolve o problema do viés de seleção ao aleatorizar a alocação do tratamento. A randomização garante, em média, que os grupos de tratamento e controle sejam idênticos em todas as características, observáveis e não observáveis. Assim, qualquer diferença nos resultados pode ser atribuída ao tratamento.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>